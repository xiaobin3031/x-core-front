import './css/button.css'

export default function Button({children, loading, ...props}) {

  if (loading) {
    props.disabled = true
  }

  const cls = props.className?.split(' ') || []
  cls.push('x-button')

  if (!props.style) {
    props.style = {}
  }

  if (!!props.color) {
    if (props.color.indexOf('#') === 0) {
      if (!props.style.color) {
        props.style.color = props.color
      }
    } else {
      cls.push(props.color)
    }
  }

  delete props.className
  return (
    <button className={cls.join(' ')}
            {...props}
    >
      {
        loading &&
        <svg className='icon' viewBox="0 0 1036 1024" version="1.1"
             xmlns="http://www.w3.org/2000/svg" width="50" height="50">
          <path
            d="M511.144516 868.596627c-176.289052 0-322.915527-126.987183-353.409029-294.455335l-6.408967 1.281179c-3.793396-16.240893-16.951067-29.987988-35.346019-34.579563-26.28055-6.576789-53.234435 7.950066-60.276828 32.417317L4.750187 750.438531c-7.014764 24.439622 8.56405 49.608861 34.815947 56.158021 26.249851 6.54609 53.231365-7.982812 60.249199-32.420387l15.270798-53.103452C190.734042 862.317621 339.715145 958.400956 511.144516 958.400956c197.718107 0 365.571023-127.800711 425.492764-305.296241l-87.510076-21.877263C799.22977 769.635755 666.74641 868.596627 511.144516 868.596627zM985.122551 242.026242c-25.606191-6.956436-52.266387 7.219425-59.545164 31.659047L914.292366 311.528176C841.156672 162.761967 688.116113 60.375066 511.144516 60.375066c-199.51094 0-368.632755 130.128733-427.121867 310.140573l81.459267 40.73168c42.706661-150.673651 181.293019-261.069971 345.662601-261.069971 184.557366 0 336.598154 139.216715 356.880083 318.353628l3.095501-1.238201c1.677199 18.482957 15.036461 34.93158 34.840506 40.312124 25.637913 6.958482 52.297087-7.220449 59.575864-31.657001l52.765761-177.063695C1025.608637 274.414907 1010.760464 248.984724 985.122551 242.026242z"
          >
            <animateTransform attributeName="transform" type="rotate"
                              attributeType="XML"
                              from="0 512 512"
                              to="360 512 512"
                              dur="2s"
                              repeatCount="indefinite"/>
          </path>
        </svg>
      }
      {children}
    </button>
  )
}